setwd("~/GitHub/kaggle-Titanic/R/")
titanic = read.csv("~/GitHub/kaggle-Titanic/data/train.csv")
titanic = read.csv("~/GitHub/kaggle-Titanic/data/train.csv")
test = read.csv("~/GitHub/kaggle-Titanic/data/test.csv")
titanic = rbind(titanic, test)
test = cbind(Survived=0, test)
titanic = rbind(titanic, test)
rm(test)
View(titanic)
test = cbind(Survived=NA, test)
test = read.csv("~/GitHub/kaggle-Titanic/data/test.csv")
test = cbind(Survived=NA, test)
titanic = rbind(titanic, test)
test$Survived = NA
View(test)
View(titanic)
titanic = read.csv("~/GitHub/kaggle-Titanic/data/train.csv")
test = read.csv("~/GitHub/kaggle-Titanic/data/test.csv")
test = cbind(Survived=NA, test)
test$Survived = NA
titanic = rbind(titanic, test)
titanic = read.csv("~/GitHub/kaggle-Titanic/data/train.csv", row.names='PassengerId')
test = read.csv("~/GitHub/kaggle-Titanic/data/test.csv", row.names='PassengerId')
test = cbind(Survived=NA, test)
test$Survived = NA
titanic = rbind(titanic, test)
train = !is.na(titanic)
View(train)
train = !is.na(titanic$Survived)
test = is.na(titanic$Survived)
titanic_o = titanic
titanic = titanic[,c(,-8,-10)]
titanic = titanic[,c(-8,-10)]
?mice
install.packages('mice')
?mice
attach(titanic)
familysize = SibSp + Parch + 1
detach(titanic)
attach(titanic)
titanic$familysize = SibSp + Parch + 1
detach(titanic)
titanic = titanic[,c(-6,-7)]
library(mice)
new = mice(titanic)
new = mice(titanic[train,])
nrow(new$data)
titanic[train,] = new$data
new
View(titanic)
complete(new)
titanic[train,] = complete(new)
titanic$Embarked[c(62,830),]
titanic[c(62,830),]$Embarked
titanic[c(62,830),]$Embarked = NA
View(titanic)
new = mice(titanic[train,])
new = mice(titanic[train,], MaxNWts=3000)
new = mice(titanic[train,], method=c('','','','','','','lda',''))
new = mice(titanic[train,], method=c('','','','','','','rf',''))
new = mice(titanic[train,], method=c('','','','','','','cart',''))
titanic[train,] = complete(new)
new$imp
new$imp$Embarked
new1 = mice(titanic[train,], method=c('','','','','','','cart',''))
titanic[c(62,830),]$Embarked = NA
new1 = mice(titanic[train,], method=c('','','','','','','cart',''))
new1 = mice(titanic[train,], method=c('','','','','','','pmm',''))
titanic[titanic$Survived==1 & titanic$Pclass==1 & titanic$Sex=='female' & titanic$familysize==1,]
summary(titanic[titanic$Survived==1 & titanic$Pclass==1 & titanic$Sex=='female' & titanic$familysize==1,])
titanic[c(62,830),]$Embarked = 'C'
View(titanic)
sub('.*?, (.*?) .*', '\\1', titanic[0,]$Name)
sub('.*?, (.*?).*', '\\1', titanic[0,]$Name)
titanic[0,]$Name
sub('.*?, (.*?).*', '\\1', titanic[1,]$Name)
titanic[1,]$Name
sub('.*?, (.*?) .*', '\\1', titanic[1,]$Name)
sub('.*?, (.*?) .*', '\\1', titanic[2,]$Name)
sub('.*?, (.*?) .*', '\\1', titanic[3,]$Name)
sub('.*?, (.*?) .*', '\\1', titanic[1:10,]$Name)
name = sub('.*?, (.*?) .*', '\\1', titanic$Name)
summary(name)
quantile(name)
quantile(as.factor(name))
quantile(factor(name))
data = data.frame(name=name)
summary(data)
name[1]
t = which(name %in% c('Mr.','Miss.','Mrs.','Master,'))
t
name[7]
name[8]
t = which(name %in% c('Mr.','Miss.','Mrs.','Master.'))
t = which(name %not in% c('Mr.','Miss.','Mrs.','Master.'))
t = !which(name %in% c('Mr.','Miss.','Mrs.','Master.'))
t[31]
t[32]
t = which(!name %in% c('Mr.','Miss.','Mrs.','Master.'))
name[31]
name[150]
name[t]
name = sub('.*?, (.*?) .*', '\\1', titanic$Name)
name[which(!name %in% c('Mr.','Miss.','Mrs.','Master.')),] = 'other'
name[which(!name %in% c('Mr.','Miss.','Mrs.','Master.'))] = 'other'
data = data.frame(name=name)
summary(data)
titanic$title = name
titanic$Name = NULL
cor(titanic[,c(-3,-8)])
cor(titanic[,c(-3,-6,-8)])
cor(titanic[,c(-1,-3,-6,-8)])
cor(titanic[,c(4,5,7)])
summary(titanic)
cor(titanic[train,c(-3,-6,-8)])
interaction.plot(titanic$Sex, titanic$Embarked, titanic$Survived)
interaction.plot(titanic[train,]$Sex, titanic[train,]$Embarked, titanic[train,]$Survived)
corrs = c(rep(0,6))
best = c(rep(0,3))
for(n in c(4,5,7)){
corrs[1] = glm(Survived ~ titanic[,n], family=binomial, data=titanic)$aic # not change
corrs[2] = glm(Survived ~ titanic[,n]^2, family=binomial, data=titanic)$aic # square
corrs[3] = glm(Survived ~ titanic[,n]^3, family=binomial, data=titanic)$aic# cube
corrs[4] = glm(Survived ~ sqrt(titanic[,n]), family=binomial, data=titanic)$aic# square root
corrs[5] = glm(Survived ~ log(titanic[,n]+1), family=binomial, data=titanic)$aic # log
corrs[6] = glm(Survived ~ 1/(titanic[,n]), family=binomial, data=titanic)$aic # reciprocal
cand = 100000000
for( i in 1:6 ){
if( corrs[i] < cand ){
cand = corrs[i]
best[n] = i
}
}
}
best
which(best %in% 5)
library(randomForest)
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], ntree=500)
titanic$title = factor(name)
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], ntree=500)
rf
varImpPlot(rf)
yhat = predict(rf, newdata=titanic[test,-1], type='response')
yhat = predict(rf, newdata=titanic[test,-1], type='response') - 1
yhat = predict(rf, newdata=titanic[test,-1], type='response')
sub = data.frame(PassengerId=892:1309, Survived=yhat)
View(sub)
yhat
titanic[test,-1] = complete(mice(titanic[test,-1]))
library('mice')
titanic[test,-1] = complete(mice(titanic[test,-1]))
summary(titanic[test,-1])
summary(titanic)
rf = randomForest(factor(Survived) ~ ., data=titanic[train,])
rf
yhat = predict(rf, newdata=titanic[test,-1], type='response')
sub = data.frame(PassengerId=892:1309, Survived=yhat)
summary(sub)
149/269
write.csv(sub, '~/GitHub/kaggle-Titanic/submission/submission_rf_new.csv', row.names = F)
all = titanic
titanic[which(best %in% 5)] = log(titanic[which(best %in% 5)] + 1)
titanic[which(best %in% 6)] = 1 / (titanic[which(best %in% 6)] + 1)
rf = randomForest(factor(Survived) ~ ., data=titanic[train,])
rf
yhat = predict(rf, newdata=titanic[test,-1], type='response')
sub = data.frame(PassengerId=892:1309, Survived=yhat)
write.csv(sub, '~/GitHub/kaggle-Titanic/submission/submission_rf_new_tf.csv', row.names = F)
write.csv(all, '~/GitHub/kaggle-Titanic/data/all.csv', row.names = F)
?randomForest
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], cutoff=c(0.4,0.6))
rf
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], cutoff=c(0.3,0.7))
rf
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], cutoff=c(0.5,0.5))
rf
rf = randomForest(factor(Survived) ~ ., data=titanic[train,], cutoff=c(0.47,0.53))
rf
yhat = predict(rf, newdata=titanic[test,-1], type='response')
sub = data.frame(PassengerId=892:1309, Survived=yhat)
summary(sub)
145/418
149/418
write.csv(sub, '~/GitHub/kaggle-Titanic/submission/submission_rf_new_tf_biased.csv', row.names = F)
save.image("~/GitHub/kaggle-Titanic/R/.RData")
setwd("~/GitHub/kaggle-Titanic/R/")
savehistory("~/GitHub/kaggle-Titanic/R/.Rhistory")
GAM = gam(Survived ~ ., data=titanic[train,], family=binomial)
library(gam)
GAM = gam(Survived ~ ., data=titanic[train,], family=binomial)
plot.gam(GAM, se=T, ask=T)
plot(titanic[train,])
logis = glm(Survived ~ .*., data=titanic[train,], family=binomial)
summary(logis)
drop1(logis, test='F')
logis = glm(Survived ~ .+Pclass:familysize+Age:title+Fare:familysize+Fare:title+familysize:title, data=titanic[train,], family=binomial)
summary(logis)
drop1(logis, test='F')
GAM = gam(Survived ~ .+Pclass:familysize+Age:title+Fare:familysize+Fare:title+familysize:title, data=titanic[train,], family=binomial)
plot.gam(GAM, se=T, ask=T)
boxplot(Pclass ~ Survived, data=titanic[train,])
plot(Pclass ~ Survived, data=titanic[train,])
plot(logis)
plot(Age ~ Survived, data=titanic[train,])
hist(Age ~ Survived, data=titanic[train,])
hist(Age, data=titanic[train,], subset=Survived==0)
hist(titanic[train,]$Age, subset=titanic$Survived==0)
plot(Age ~ Fare, data=titanic[train,])
View(titanic)
View(all)
write.csv(all, '~/GitHub/kaggle-Titanic/data/all_tf.csv', row.names = F)
write.csv(titanic, '~/GitHub/kaggle-Titanic/data/all_tf.csv', row.names = F)
source('~/GitHub/kaggle-Titanic/R/analysis.R')
save.image("~/GitHub/kaggle-Titanic/R/.RData")
savehistory("~/GitHub/kaggle-Titanic/R/.Rhistory")
View(all)
ggplot(all, aes(x=Age, y=Survived))
library(ggplot2)
ggplot(all, aes(x=Age, y=Survived)) + geom_point()
ggplot(all[train,], aes(x=Age, y=Survived)) + geom_point()
ggplot(all[train,], aes(x=Survived, y=Age)) + geom_point()
ggplot(all[train,], aes(x=Age, col=Survived)) + geom_histogram()
ggplot(all[train,], aes(x=Survived, y=Age)) + geom_boxplot()
ggplot(all[train,], aes(x=factor(Survived), y=Age)) + geom_boxplot()
ggplot(all[train,], aes(x=Age, y=Survived)) + geom_point()
